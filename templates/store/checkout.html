{% extends "base.html" %}

{% block content %}
    <main>
        <!-- Checkout Page -->
        <section id="checkout" class="page">
            <div class="container mx-auto px-6 py-16">
                <h1 class="text-4xl font-serif text-center text-primary mb-10">Checkout</h1>
                <form action="{% url 'place_order' %}" method="POST" class="flex flex-col lg:flex-row-reverse gap-10">
                    {% csrf_token %}
                    <div class="w-full lg:w-1/3">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h2 class="text-2xl font-semibold border-b pb-3 mb-4">Your Order</h2>
                            {% for cart_item in cart_items %}
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-text-dark">
                                    {{ cart_item.product.product_name }} x {{ cart_item.quantity }}<br>
                                    <span class="text-xs">
                                        {% if cart_item.variations.all %}
                                            {% for item in cart_item.variations.all %}
                                                {{ item.variation_category | capfirst }}: {{ item.variation_value | capfirst }}<span class="last:hidden">,</span>
                                            {% endfor %}
                                        {% endif %}
                                    </span>
                                </span>
                                <span class="font-semibold">
                                    ₹{{ cart_item.sub_total }}<br>
                                    <span class="font-normal text-xs">₹{{ cart_item.product.price }} each</span>
                                </span>
                            </div>
                            {% endfor %}
                            <div class="border-t pt-4 mt-4 space-y-2">
                                <div class="flex justify-between"><span>Subtotal</span><span>₹{{ total }}</span></div>
                                <div class="flex justify-between"><span>Shipping</span><span>₹{{ shipping }}</span></div>
                                <div class="flex justify-between font-bold text-xl"><span>Total</span><span>₹{{ grand_total }}</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="w-full lg:w-2/3 bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-2xl font-semibold mb-4">Shipping Address</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="block mb-1">First Name</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="first_name" />
                            </div>
                            <div>
                                <label class="block mb-1">Last Name</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="last_name" />
                            </div>
                            <div>
                                <label class="block mb-1">Mobile Number</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="phone" />
                            </div>
                            <div>
                                <label class="block mb-1">Email Address</label>
                                <input type="email" class="w-full p-2 border rounded-md" name="email" />
                            </div>
                            <div class="md:col-span-2">
                                <label class="block mb-1">Address Line 1</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="address_line_1" />
                            </div>
                            <div class="md:col-span-2">
                                <label class="block mb-1">Address Line 2</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="address_line_2" />
                            </div>
                            <div>
                                <label class="block mb-1">Landmark</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="landmark" />
                            </div>
                            <div>
                                <label class="block mb-1">Postal Code</label>
                                <input type="number" class="w-full p-2 border rounded-md" name="postal_code" />
                            </div>
                            <div>
                                <label class="block mb-1">City</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="city" />
                            </div>
                            <div>
                                <label class="block mb-1">State</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="state" />
                            </div>
                            <div>
                                <label class="block mb-1">Country</label>
                                <input type="text" class="w-full p-2 border rounded-md" name="country" />
                            </div>
                            <div class="md:col-span-2">
                                <label class="block mb-1">Order Note</label>
                                <textarea class="w-full p-2 border rounded-md" name="order_note"></textarea>
                            </div>
                        </div>
                        <h2 class="text-2xl font-semibold mb-4">Payment Information</h2>
                        <div><label class="block mb-1">Card Number</label><input type="text" class="w-full p-2 border rounded-md" placeholder="**** **** **** ****"></div>
                        <div class="grid grid-cols-2 gap-4 mt-4">
                            <div><label class="block mb-1">Expiry Date</label><input type="text" class="w-full p-2 border rounded-md" placeholder="MM/YY"></div>
                            <div><label class="block mb-1">CVC</label><input type="text" class="w-full p-2 border rounded-md" placeholder="123"></div>
                        </div>
                        <button type="submit" class="block text-center bg-primary text-white w-full py-3 mt-8 rounded-md font-semibold hover:bg-opacity-90 transition">Place Order</button>
                    </div>
                </form>
            </div>
        </section>
    </main>
{% endblock content %}